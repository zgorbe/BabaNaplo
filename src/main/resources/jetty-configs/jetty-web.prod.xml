<?xml version="1.0" encoding="UTF-8"?>

<Configure id='wac' class="org.eclipse.jetty.webapp.WebAppContext">
<New id="myds" class="org.eclipse.jetty.plus.jndi.Resource">
  <Arg><Ref id="wac"/></Arg>
  <Arg>jdbc/DiaryDS</Arg>
  <Arg>
    <New class="org.apache.commons.dbcp.BasicDataSource">
      <Set name="driverClassName">${database.driverClassName}</Set>
      <Set name="url">#{ 'jdbc:postgresql://' + @dbUrl.getHost() + @dbUrl.getPath() }</Set>
      <Set name="username">#{ @dbUrl.getUserInfo().split(':')[0] }</Set>
      <Set name="password">#{ @dbUrl.getUserInfo().split(':')[1] }</Set>
    </New>
  </Arg>
</New>
</Configure>
